<!--Container Main start-->
<div class=" " style="max-height: 720px; height: 720px;">
    <div class="container p-5 mt-5" >
        <h2> Dashboard Principal</h2>
        <div class="row">

            <div class="col-md-8">
                <div class="card medium-card" >
                   
                </div>
            </div>
            <div class="col-md-4">
                <h4>Variação Mensal</h4>
                <div class="card small-card" >
                </div>
                
            </div>
        </div>
        <div class="row">
            <div class="col-md-8">
                <div class="row">
                    <div class="col-6">
                        
                        <h4>Variação Mensal</h4>
                        <form class ="form-group row " action="#">
                            <label for="products" class="col-sm-3 col-form-label col-form-label-sm">Produto</label>
                            <div class="col-sm-9">
                                <select class=" form-control form-control-sm" name="products" id="products"
                                    onchange="criarBoxPlot(value)">
                                    <option value="" selected>Selecione...</option>
                                </select>
                            </div>
                        
                        </form>
                        <div class=" card chart-card" id="boxplot">
                        </div>
                    </div>
                    <div class="col-6">
                        <h4>Mínimo e máximo mensais</h4>
                        <div class="card small-card">
                        </div>
                    </div>
                </div>
                
            </div>
            <div class="col-md-4">
                <h4>Variação Mensal</h4>
                <div class="card">
                    <img src="https://s2.glbimg.com/dgW_NN1AnuA1KwbUuBFVpm82Hvo=/0x0:1024x682/984x0/smart/filters:strip_icc()/i.s3.glbimg.com/v1/AUTH_59edd422c0c84a879bd37670ae4f538a/internal_photos/bs/2021/8/Y/xICwabTPOlLrrDTH9IGg/ap21125534338996.jpg" class="card-img-top" alt="...">
                    
                </div>
            </div>
        </div>

    </div>
        
</div>
<script type="text/javascript" src = "conversor_nomes_mercados_e_produtos.js"></script>
<script type="text/javascript">
    var dados = <%- JSON.stringify(dados) %>;
    let elementoAtivo = document.getElementById("produto").classList.add("active")
    const seletorProduto = document.querySelector("select#products")


    function criarBoxPlot(produto){

        if(produto == ""){
            Plotly.purge("boxplot")
            return
        };



        var y0 = [];
        var y1 = [];
        for (var i = 0; i < 50; i ++) {
            y0[i] = Math.random();
            y1[i] = Math.random() + 1;
        }

        var trace1 = {
        y: y0,
        type: 'box'
        };


        var data = [trace1];

        Plotly.newPlot('boxplot', data);
    }
    
    carregarSeletorProduto()

    function carregarSeletorProduto() {
        let produtos = dados
            .flatMap(dia => Object.keys(dia.itens)) //lista de nomes de produtos
        produtos = [...new Set(produtos)] //sem repeticao
            .sort() //ordem alfabetica

        // Criar as opcoes referentes aos mercados
        seletorProduto.innerHTML = 
            produtos.reduce((html, produto) => html += `<option value=${produto}>
                ${conversorProduto(produto).tela}</option>`,
                "<option value='' selected>Selecione...</option>")
    }

</script>
<script type="text/javascript" src = "script.js"></script>